<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Shopify Report</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css" rel="stylesheet">
    <style>
        .table-striped tbody tr:nth-of-type(odd) {
            background-color: rgba(0,0,0,.05);
        }

        body {
        }
        .table-responsive {
            width: 100%;
            margin-top: 20px;
        }
        #downloadCsv {
            margin-top: 20px;
        }
        .pagination {
            margin-top: 20px;
        }
        /* Custom styles for the table */
        .table thead th {
            background-color: #4CAF50;
            color: white;
        }
        .table tbody tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .table tbody tr:hover {
            background-color: #ddd;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
</head>
<body>
<div>
    <button id="backButton" onclick="goBack()" style="position: fixed; top: 10px; left: 10px;">Back</button>
    <button id="homeButton" onclick="goBack()" style="position: fixed; top: 10px; left: 60px;background-color:#28a745;color:#ffff">Home</button>
</div>

<div class="container">
    <div class="form-group">
        <label for="startDate">Start Date:</label>
        <input type="text" id="startDate" class="form-control">
    </div>
    <div class="form-group">
        <input type="text" id="endDate" class="form-control">
    </div>
    <!--<div class="form-group">
        <label for="search">Search:</label>
        <input type="text" id="search" class="form-control" placeholder="Search...">
    </div>-->
    <div class="form-group">
        <button id="generateReport" class="btn btn-primary" >Generate Report</button>
    </div>
    <div class="table-responsive">
        <table class="table table-bordered table-striped" id="reportTable">
            <thead>
                <tr>
                    <th>Invoice no</th>
                    <th>Product Title</th>
                    <th>Product Type</th>
                    <th>Order or Return</th>
                    <th>Day</th>
                    <th>State</th>
                    <th>State Code</th>
                    <th>Quantity</th>
                    <th>HSN Code</th>
                    <th>IGST_PCT</th>
                    <th>IGST_Amount</th>
                    <th>SGST_PCT</th>
                    <th>SGST_Amount</th>
                    <th>CGST_PCT</th>
                    <th>CGST_Amount</th>
                    <th>Net Sales</th>
                    <th>Taxes</th>
                    <th>Total Sales</th>
                    <th>Tax Amount</th>
                    <!-- Add other columns as needed -->
                </tr>
            </thead>
            <tbody>
                <tr th:each="report : ${reportDetailsList}">
                    <td th:text="${report.orderId}"></td>
                    <td th:text="${report.productTitle}"></td>
                    <td th:text="${report.productType}"></td>
                    <td th:text="${report.orderOrReturn}"></td>
                    <td th:text="${report.day}"></td>
                    <td th:text="${report.billingRegion}"></td>
                    <td th:text="${report.stateCode}"></td>
                    <td th:text="${report.netItemsSold}"></td>
                    <td th:text="${report.hsnCode}"></td>
                    <td th:text="${report.igstPerc}"></td>
                    <td th:text="${report.igstAmount}"></td>
                    <td th:text="${report.sgstPerc}"></td>
                    <td th:text="${report.sgstAmount}"></td>
                    <td th:text="${report.cgstPerc}"></td>
                    <td th:text="${report.cgstAmount}"></td>
                    <td th:text="${report.netSales}"></td>
                    <td th:text="${report.taxes}"></td>
                    <td th:text="${report.totalSales}"></td>
                    <!-- Add other columns as needed -->
                </tr>
            </tbody>
        </table>
    </div>
    <nav>
        <ul class="pagination">
            <li class="page-item"><a class="page-link" href="#" id="prevPage">Previous</a></li>
            <li class="page-item"><a class="page-link" href="#" id="nextPage">Next</a></li>
        </ul>
    </nav>
    <button class="btn btn-primary" id="downloadCsv">Download as CSV</button>
</div>

<script>
$(document).ready(function() {
    // Initialize date pickers
    $('#startDate').daterangepicker({
        singleDatePicker: true,
        showDropdowns: true
    });

    $('#endDate').daterangepicker({
        singleDatePicker: true,
        showDropdowns: true
    });

    // Pagination variables
    var currentPage = 1;
    var rowsPerPage = 10000;

    // Function to display a specific page
    function displayPage(page) {
        var rows = $('#reportTable tbody tr');
        var totalRows = rows.length;
        var totalPages = Math.ceil(totalRows / rowsPerPage);

        rows.hide();
        rows.slice((page - 1) * rowsPerPage, page * rowsPerPage).show();

        $('#prevPage').parent().toggleClass('disabled', page === 1);
        $('#nextPage').parent().toggleClass('disabled', page === totalPages);
    }

    // Event listeners for pagination
    $('#prevPage').click(function(e) {
        e.preventDefault();
        if (currentPage > 1) {
            currentPage--;
            displayPage(currentPage);
        }
    });

    $('#nextPage').click(function(e) {
        e.preventDefault();
        var rows = $('#reportTable tbody tr');
        var totalRows = rows.length;
        var totalPages = Math.ceil(totalRows / rowsPerPage);
        if (currentPage < totalPages) {
            currentPage++;
            displayPage(currentPage);
        }
    });

    // Initial display
    displayPage(currentPage);

    // Search functionality
    $('#search').on('keyup', function() {
        var value = $(this).val().toLowerCase();
        $('#reportTable tbody tr').filter(function() {
            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
        });
        currentPage = 1;
        displayPage(currentPage);
    });

    // Download table data as CSV
    $('#downloadCsv').click(function() {
        var csv = [];
        $('#reportTable tr').each(function() {
            var row = [];
            $(this).find('td, th').each(function() {
                row.push($(this).text());
            });
            csv.push(row.join(','));
        });
        var csvString = csv.join('\n');
        var blob = new Blob([csvString], { type: 'text/csv' });
        var url = URL.createObjectURL(blob);
        var a = document.createElement('a');
        a.href = url;
        a.download = 'report.csv';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    });
});
        function goBack() {
        window.history.back(); // Navigate to the previous page
    }
</script>
</body>
</html>